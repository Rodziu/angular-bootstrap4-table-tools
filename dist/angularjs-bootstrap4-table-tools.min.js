angular.module("tableTools",["tableTools.search","tableTools.pagination","tableTools.export","tableTools.select","tableTools.sort"]),angular.module("tableTools.export",["angularBS"]),angular.module("tableTools.pagination",[]),angular.module("tableTools.search",[]),angular.module("tableTools.select",[]),angular.module("tableTools.sort",[]),function(){"use strict";function t(t){a.$inject=["$element","$document","$window","$filter","$q","$http","$timeout","$log","tableTools","ttPagination","ttSearch","ttSort","ttSelect"];const e=function(e,a){const l=t.scrollY,o=performance.now(),n=function(r){const i=r-o;i>=1e3?t.scrollTo(0,e):(t.scrollTo(0,l-Math.sin(Math.PI/2/(a/i))*(l-e)),t.requestAnimationFrame(n))};t.requestAnimationFrame(n)};return{restrict:"A",scope:!0,bindToController:{tableTools:"<",perPage:"<",perPageOptions:"<",order:"=?",ttUrl:"@",ttResolver:"<"},controllerAs:"tableTools",controller:a};function a(t,a,l,o,n,r,i,s,c,u,g,p,d){const f=this;f.$onInit=function(){f.data=[],f.dataLength=0,f.$element=t,f.lang=c.lang,f.ttSearch=new g,f.pagination=new u,f.ttSort=new p,f.ttSelect=new d(f),angular.isUndefined(f.perPage)&&(f.perPage=c.perPage),angular.isUndefined(f.perPageOptions)&&(f.perPageOptions=c.perPageOptions),angular.isDefined(f.ttUrl)&&!angular.isFunction(f.ttResolver)&&(angular.isFunction(c.defaultTableToolsResolver)?f.ttResolver=c.defaultTableToolsResolver:f.ttResolver=function(t,e,a,l,o,i){const s=n.defer();return r.post(i,{getTableToolsData:1,limit:t,offset:e,order:a,search:l,filters:o}).then(function(t){s.resolve(t.data)}).catch(function(){s.reject()}),s.promise}),f.filterData()},f.$onChanges=function(t){"tableTools"in t&&f.filterData()},f.$doCheck=function(){f.ttSort.orderUpdate(f.order)&&f.filterData()};let m={id:0,timeout:null};f.filterData=function(){if(angular.isUndefined(f.ttSearch))return;let t;if(f.loading=!0,angular.isFunction(f.ttResolver)){t=0,null!==m.timeout&&(i.cancel(m.timeout),t=750);let e=++m.id;m.timeout=i(function(){f.ttResolver(f.perPage,(f.pagination.page-1)*f.perPage,f.ttSort.getOrder(f.order),f.ttSearch.search,f.ttSearch.getFiltersArray(),f.ttUrl).then(function(t){if(angular.isUndefined(t.data)||!angular.isNumber(t.count)||!angular.isNumber(t.countFiltered))throw new Error("TableTools - wrong result format");m.id===e&&(f.data=t.data,f.dataLength=t.count,f.filteredCount=t.countFiltered)}).catch(function(t){s.error(t),m.id===e&&(f.data=[],f.dataLength=0,f.filteredCount=0)}).finally(function(){m.id===e&&(f.pagination.paginate(f.filteredCount,f.perPage),f.ttSelect.change(),f.loading=!1,m.timeout=null)})},t)}else t=0,null!==m.timeout&&(i.cancel(m.timeout),t=50),m.timeout=i(function(){f.data=angular.copy(f.tableTools),f.dataLength=f.data.length,f.data=f.ttSearch.doSearch(f.data),f.filteredCount=f.data.length,f.data=o("orderBy")(f.data,f.order,!1,f.ttSort.compareFn),f.pagination.paginate(f.data.length,f.perPage),f.data=o("limitTo")(f.data,f.perPage,f.pagination.start-1),f.ttSelect.change(),m.timeout=null,f.loading=!1},t)},f.changePage=function(o){const n=f.pagination.page;"prev"===o?f.pagination.page>1&&f.pagination.page--:"next"===o?f.pagination.page<f.pagination.pages&&f.pagination.page++:isNaN(o)||(f.pagination.page=o),n!==f.pagination.page&&f.filterData(),e(Math.round(t[0].getBoundingClientRect().top+(l.pageYOffset||a[0].documentElement.scrollTop))+c.scrollOffset,1e3)}}}t.$inject=["$window"],angular.module("tableTools").directive("tableTools",t)}(),function(){"use strict";angular.module("tableTools").provider("tableTools",function(){this.perPage=25,this.perPageOptions=[{number:10,text:10},{number:25,text:25},{number:50,text:50},{number:100,text:100},{number:200,text:200},{number:1/0,text:"Wszystkie"}],this.scrollOffset=0,this.lang={first:"Pierwsza strona",prev:"Poprzednia strona",next:"Następna strona",last:"Ostatnia strona",results:"Wyniki:",from:"z",perPage:"Wyników na stronę:",search:"Szukaj...",filteredResults:"Filtrowanie z:",export:"Export",exportChooseColumns:"Wybierz kolumny",flipSelection:"odwróć zaznaczenie",exportColumnNames:"Eksportuj nazwy kolumn",exportSeparator:"Separator",tabulator:"Tabulator",copy:"Kopiuj",csv:"CSV",copiedToClipboard:"Skopiowano do schowka"},this.exportTypes={copy:{lang:this.lang.copy},csv:{lang:this.lang.csv,parseText:function(t){return'"'+t.replace('"','""')+'"'}}},this.exportNotification=function(t){"copy"===t&&alert(this.lang.copiedToClipboard)},this.$get=function(){return this}})}(),function(){"use strict";angular.module("tableTools").component("ttHeader",{require:{tableTools:"^tableTools"},template:'<div><div class="form-inline"><tt-per-page></tt-per-page><tt-loading></tt-loading><tt-search class="ml-auto"></tt-search></div><tt-pagination class="tt-pagination-top"><div class="pull-right tt-export"><tt-export></tt-export></div></tt-pagination></div>'})}(),function(){"use strict";angular.module("tableTools").component("ttLoading",{require:{tableTools:"^tableTools"},controllerAs:"vm",template:'<span ng-show="vm.tableTools.loading">&nbsp;<i class="fa fa-spinner fa-spin fa-lg"></i></span>'})}(),function(){"use strict";class t{constructor(t,e,a){this.$document=t,this.$q=e,this.tableTools=a,this.exportTypes=a.exportTypes,this.separators=[{lang:",",separator:","},{lang:";",separator:";"},{lang:a.lang.tabulator,separator:"\t"}],this.modal=!1,this.exporting=!1,this.config={separator:",",fileName:"",columnNames:!0}}showExport(){const t=this.tableToolsCtrl.$element[0].querySelectorAll("table > thead > tr:last-child > th");this.columns=[];for(let e=0;e<t.length;e++)angular.element(t[e]).hasClass("ignore-export")||this.columns.push({txt:t[e].innerHTML,idx:e,exp:!0});this.config.fileName=this.$document[0].title,this.modal=!0}flipSelection(){for(let t=0;t<this.columns.length;t++)this.columns[t].exp=!this.columns[t].exp}doExport(t,e){this.exporting=t;const a=[],l=[],o=function(t){return angular.isFunction(e.parseText)&&(t=e.parseText(t)),t},n=()=>{r.length&&("csv"===t||"copy"===t?l.push(r.join(this.config.separator)):l.push(r),r=[])};let r=[];for(let t=0;t<this.columns.length;t++)this.columns[t].exp&&(a.push(this.columns[t].idx),this.config.columnNames&&r.push(o(this.columns[t].txt)));n();const i=this.tableToolsCtrl.$element[0].querySelectorAll("table > tbody > tr:not(.ignore-export) > td");let s,c=-1;for(let t=0;t<i.length;t++)~a.indexOf(i[t].cellIndex)&&(i[t].parentNode.rowIndex!==c&&(c=i[t].parentNode.rowIndex,n()),r.push(o(angular.element(i[t]).text().trim())));switch(n(),t){case"copy":s=(t=>{let e=this._getCopyElement();e.val(t.join("\n")),e[0].focus(),e[0].select(),this.$document[0].execCommand("copy")});break;case"csv":s=((t,e)=>{const a=this.$document[0].createElement("a"),l="\ufeff"+t.join("\n"),o=new Blob([l],{type:"text/csv",charset:"utf-8"}),n=URL.createObjectURL(o);a.setAttribute("style","display: none"),a.href=n,a.download=e.fileName+".csv",this.$document[0].body.appendChild(a),a.click(),a.remove()});break;default:if(!angular.isFunction(e.callback))throw new Error("No callback provided for export type: "+t);s=e.callback}this.$q.when(s(l,this.config)).then(()=>{angular.isFunction(this.tableTools.exportNotification)&&this.tableTools.exportNotification(t),this.exporting=!1,this.modal=!1})}_getCopyElement(){return angular.isUndefined(this._copyElement)&&(this._copyElement=angular.element('<textarea style="position:absolute;top:-1000px;left:-1000px"></textarea>'),angular.element(this.$document[0].body).append(this._copyElement)),this._copyElement}}t.$inject=["$document","$q","tableTools"],angular.module("tableTools.export").component("ttExport",{controller:t,controllerAs:"vm",require:{tableToolsCtrl:"^tableTools"},templateUrl:"src/templates/export.html"})}(),angular.module("tableTools.pagination").component("ttPagination",{require:{tableTools:"^tableTools"},controllerAs:"vm",transclude:!0,templateUrl:"src/templates/pagination.html"}),function(){"use strict";angular.module("tableTools.pagination").factory("ttPagination",function(){return function(t){isNaN(t)&&(t=5);const e=this,a=Math.floor(t/2);e.page=1,e.pages=1,e.start=0,e.end=0,e.items=[],e.paginate=function(l,o){e.pages=Math.ceil(l/o),0===e.pages&&(e.pages=1),e.page>e.pages&&(e.page=e.pages),e.items=[];let n=e.pages-e.page,r=e.page-(n<a?t-1-n:a);r<1&&(r=1);do{e.items.push(r),r++}while(e.items.length<t&&r<=e.pages);e.start=o===1/0?1:Math.min((e.page-1)*o+1,l),e.end=Math.min(e.page*o,l)}}})}(),angular.module("tableTools.pagination").component("ttPerPage",{require:{tableTools:"^tableTools"},controllerAs:"vm",template:'<div class="form-group"><label>{{::vm.tableTools.lang.perPage}}&nbsp;</label><select class="form-control" ng-model="vm.tableTools.perPage" ng-change="vm.tableTools.filterData()" ng-options="o.number as o.text for o in vm.tableTools.perPageOptions"></select></div>'}),function(){"use strict";function t(t){const e=this;"type"in t&&"checkbox"===t.type&&t.$observe("value",function(t){e.value=t}),e.getValue=function(){return angular.isDefined(e.value)?e.ngModel?e.value:e.ttFilterEmpty:e.ngModel},e.init=function(){angular.isUndefined(e.ttFilterOperator)&&(e.ttFilterOperator="=="),angular.isUndefined(e.ttFilterEmpty)&&(e.ttFilterEmpty=""),e.ttFilterOr="ttFilterOr"in t||"type"in t&&"checkbox"===t.type,e.tableTools.ttSearch.registerFilter(e.ttFilter,e),e.tableTools.filterData()},e.$onChanges=function(t){"ngModel"in t&&"tableTools"in e&&e.tableTools.filterData()},e.$onDestroy=function(){e.tableTools.ttSearch.unregisterFilter(e.ttFilter,e)}}t.$inject=["$attrs"],angular.module("tableTools.search").directive("ttFilter",function(){return{restrict:"A",require:["ttFilter","^tableTools","ngModel"],link(t,e,a,l){l[0].tableTools=l[1],l[0].init()},bindToController:{ttFilter:"@",ttFilterOperator:"@",ttFilterEmpty:"@",ngModel:"<"},controller:t}})}(),angular.module("tableTools.search").component("ttSearch",{require:{tableTools:"^tableTools"},controllerAs:"vm",template:'<div class="form-group"><input type="text" class="form-control" ng-model="vm.tableTools.ttSearch.search" ng-change="vm.tableTools.filterData()" placeholder="{{::vm.tableTools.lang.search}}"/></div>'}),function(){"use strict";angular.module("tableTools.search").factory("ttSearch",function(){const t=function(e,a,l){if(angular.isObject(a)){for(let o in a)if(a.hasOwnProperty(o)&&t(e,a[o],l))return!0;return!1}if(angular.isObject(e)){for(const o in e)if(e.hasOwnProperty(o)&&"$$hashKey"!==o&&t(e[o],a,l))return!0;return!1}if(angular.isUndefined(l)||"like"===l)return!!~e.toLowerCase().indexOf(a.toLowerCase());switch(l){case">":return e>a;case"<":return e<a;case">=":return e>=a;case"<=":return e<=a;case"==":return e==a;default:return!0}},e=function(t,a){if(angular.isObject(t)){for(const l in t)if(t.hasOwnProperty(l)&&"$$hashKey"!==l&&e(t[l],a))return!0}else if(angular.isNumber(t)&&t==a||angular.isString(t)&&~t.toLowerCase().indexOf(a))return!0;return!1};return function(){const a=this,l={};a.search="",a.registerFilter=function(t,e){t in l||(l[t]=[]),l[t].push(e)},a.unregisterFilter=function(t,e){l[t].splice(l[t].indexOf(e),1),l[t].length||delete l[t]},a.getFiltersArray=function(){const t={};for(const e in l)if(l.hasOwnProperty(e)){t[e]=[];for(let a=0;a<l[e].length;a++){const o=l[e][a],n=o.getValue();angular.isUndefined(n)||n==o.ttFilterEmpty||angular.isDefined(o.length)&&!o.length||t[e].push({value:n,operator:o.ttFilterOperator,isOr:o.ttFilterOr})}}return t},a.doSearch=function(o){if(!o.length||(!angular.isString(a.search)&&!angular.isNumber(a.search)||""===a.search)&&!Object.keys(l).length)return o;const n=[],r=angular.isString(a.search)?a.search.toLowerCase():angular.isNumber(a.search)?a.search:"";return angular.forEach(o,a=>{if(""===r||e(a,r)){for(const e in l)if(l.hasOwnProperty(e)&&angular.isDefined(a[e])){let o=!0,n=!1,r=!1;for(let i=0;i<l[e].length;i++){const s=l[e][i],c=s.getValue();if(!(angular.isUndefined(c)||c==s.ttFilterEmpty||angular.isDefined(s.length)&&!s.length))if(t(a[e],c,s.ttFilterOperator))n=!0;else{if(!s.ttFilterOr){o=!1;break}r=!0}}if(r&&!n&&(o=!1),!o)return}n.push(a)}}),n}}})}(),function(){"use strict";angular.module("tableTools.select").directive("ttSelectAll",function(){return{restrict:"AE",require:"^tableTools",template:'<input type="checkbox" class="tt-select-all" ng-model="tableTools.ttSelect.selectAll" ng-change="tableTools.ttSelect.changeAll()"/>',replace:!0}})}(),function(){"use strict";angular.module("tableTools.select").directive("ttSelect",function(){return{restrict:"AE",require:"^tableTools",template:'<input type="checkbox" ng-model="row.ttSelected" ng-disabled="!row.ttSelectable" ng-change="tableTools.ttSelect.change()"/>',replace:!0,scope:{row:"=ttSelect"},link(t,e,a,l){t.tableTools=l,angular.isUndefined(t.row.ttSelectable)&&(t.row.ttSelectable=!0)}}})}(),function(){"use strict";angular.module("tableTools.select").factory("ttSelect",function(){return function(t){const e=this;e.selectAll=!1,e.changeAll=function(){for(let a=0;a<t.data.length;a++)t.data[a].ttSelected=!1!==t.data[a].ttSelectable&&e.selectAll},e.change=function(){for(let a=0;a<t.data.length;a++)if(!t.data[a].ttSelected&&!1!==t.data[a].ttSelectable)return void(e.selectAll=!1);e.selectAll=!0},e.getSelected=function(){const e=[];for(let a=0;a<t.data.length;a++)t.data[a].ttSelected&&!1!==t.data[a].ttSelectable&&e.push(t.data[a]);return e},e.hasSelected=function(){return 0!==e.getSelected().length}}})}(),function(){"use strict";angular.module("tableTools.select").directive("ttSelectedClick",function(){return{restrict:"AE",require:"^tableTools",replace:!0,scope:{ttSelectedClick:"<"},link(t,e,a,l){t.isDisabled=function(){return!l.ttSelect.hasSelected()},t.$watch("isDisabled()",function(t){e.attr("disabled",t)}),e.on("click",function(){const e=l.ttSelect.getSelected();e.length&&(t.ttSelectedClick(e),t.$apply())})}}})}(),function(){"use strict";angular.module("tableTools.sort").directive("ttSort",function(){return{restrict:"A",require:["^tableTools","ttSort"],controller:["$element",function(t){this.updateState=function(e){this.state!==e&&(this.state&&t.removeClass("sorting-"+this.state),e&&t.addClass("sorting-"+e),this.state=e)}}],link(t,e,a,l){const o=l[0],n=l[1];o.ttSort.register(a.ttSort,n),t.$on("$destroy",function(){o.ttSort.unregister(a.ttSort,n)}),e.on("click",function(e){if(e.shiftKey){angular.isString(o.order)?o.order=[o.order]:angular.isArray(o.order)||(o.order=[]);let t=!1;for(let e=0;e<o.order.length;e++){if(o.order[e]===a.ttSort){o.order[e]="-"+a.ttSort,t=!0;break}if(o.order[e]==="-"+a.ttSort){o.order[e]=a.ttSort,t=!0;break}}t||o.order.push(a.ttSort)}else o.order===a.ttSort?o.order="-"+a.ttSort:o.order=a.ttSort;t.$apply()})}}})}(),function(){"use strict";angular.module("tableTools.sort").factory("ttSort",function(){const t=function(t){return null!==t&&angular.isObject(t)},e=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},a=function(a,l){if(a.type!==l.type)return a.type<l.type?-1:1;if("string"===a.type){if(e(a.value)&&e(l.value))return parseFloat(a.value)<parseFloat(l.value)?-1:1;a.value=a.value.toLowerCase(),l.value=l.value.toLowerCase()}else"object"===a.type&&(t(a.value)&&(a.value=a.index),t(l.value)&&(l.value=l.index));return a.value!==l.value?angular.isFunction(a.value.localeCompare)?a.value.localeCompare(l.value):a.value<l.value?-1:1:void 0};return function(){const t={},e=function(t,e){"-"===t[0]?e[t.substring(1)]="desc":e[t]="asc"},l=function(t){const a={};if(angular.isDefined(t))if(angular.isString(t))e(t,a);else if(angular.isDefined(t.length))for(let l=0;l<t.length;l++)e(t[l],a);return a};let o,n=0,r=0;this.compareFn=a,this.register=function(e,a){e in t||(t[e]=[]),t[e].push(a),n++},this.unregister=function(e,a){t[e].splice(t[e].indexOf(a),1),t[e].length||delete t[e],n++},this.getOrder=function(t){const e=[],a=l(t);for(const t in a)a.hasOwnProperty(t)&&e.push({col:t,dir:a[t]});return e},this.orderUpdate=function(e){if(!angular.equals(e,o)||r!==n){const a=l(e);for(let e in t)if(t.hasOwnProperty(e))for(let l=0;l<t[e].length;l++)t[e][l].updateState(a[e]);return o=angular.copy(e),r=n,!0}return!1}}})}(),angular.module("tableTools").run(["$templateCache",function(t){t.put("src/templates/export.html",'<div><button class="btn btn-outline-primary" ng-click="vm.showExport()">{{::vm.tableTools.lang.export}}</button><div class="modal fade" bs-modal="vm.modal"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">{{::vm.tableTools.lang.export}}</h5><button type="button" class="close" dismiss aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"><div class="form-group"><label><strong>{{::vm.tableTools.lang.exportChooseColumns}}:</strong> <a href="javascript:" ng-click="vm.flipSelection()" class="badge badge-primary">{{::vm.tableTools.lang.flipSelection}}</a></label><div><div class="form-check form-check-inline" ng-repeat="c in vm.columns"><input class="form-check-input" type="checkbox" id="tt-export-{{::$id}}" ng-model="c.exp"> <label class="form-check-label" for="tt-export-{{::$id}}" title="c.txt">{{::c.txt}}</label></div></div><div><div class="form-check mt-2"><input class="form-check-input" type="checkbox" id="tt-export-columns-{{::$id}}" ng-model="vm.config.columnNames"> <label class="form-check-label" for="tt-export-columns-{{::$id}}">{{::vm.tableTools.lang.exportColumnNames}}</label></div></div></div><div class="form-group"><label><strong>{{::vm.tableTools.lang.exportSeparator}}</strong></label><div><div class="form-check form-check-inline" ng-repeat="s in vm.separators"><input class="form-check-input" type="radio" id="tt-export-separator-{{::$id}}" ng-model="vm.config.separator" ng-value="s.separator" ng-trim="false"> <label class="form-check-label" for="tt-export-separator-{{::$id}}">{{::s.lang}}</label></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-outline-primary" ng-repeat="(k, e) in vm.exportTypes" ng-click="vm.doExport(k, e)" ng-disabled="vm.exporting">{{::e.lang}} <span ng-if="vm.exporting == k"><i class="fa fa-spinner fa-spin"></i></span></button></div></div></div></div></div>'),t.put("src/templates/pagination.html",'<ng-transclude></ng-transclude><div class="pull-right"><ul class="pagination"><li ng-class="{\'disabled\': vm.tableTools.pagination.page == 1}" class="page-item"><a href="javascript:" ng-click="vm.tableTools.changePage(1)" title="{{::vm.tableTools.lang.first}}" class="page-link"><i class="fa fa-angle-double-left"></i></a></li><li ng-class="{\'disabled\': vm.tableTools.pagination.page == 1}" class="page-item"><a href="javascript:" ng-click="vm.tableTools.changePage(\'prev\')" title="{{::vm.tableTools.lang.prev}}" class="page-link"><i class="fa fa-angle-left"></i></a></li><li ng-repeat="p in vm.tableTools.pagination.items" ng-class="{\'active\': p == vm.tableTools.pagination.page}" class="page-item"><a href="javascript:" ng-click="vm.tableTools.changePage(p)" class="page-link">{{p}}</a></li><li ng-class="{\'disabled\': vm.tableTools.pagination.page == vm.tableTools.pagination.pages || vm.tableTools.pagination.pages == 0}" class="page-item"><a href="javascript:" ng-click="vm.tableTools.changePage(\'next\')" title="{{::vm.tableTools.lang.next}}" class="page-link"><i class="fa fa-angle-right"></i></a></li><li ng-class="{\'disabled\': vm.tableTools.pagination.page == vm.tableTools.pagination.pages || vm.tableTools.pagination.pages == 0}" class="page-item"><a href="javascript:" ng-click="vm.tableTools.changePage(vm.tableTools.pagination.pages)" title="{{::vm.tableTools.lang.last}}" class="page-link"><i class="fa fa-angle-double-right"></i></a></li></ul></div><div class="pagination-desc">{{::vm.tableTools.lang.results}} <span ng-switch="vm.tableTools.dataLength"><span ng-switch-when="0">0</span> <span ng-switch-default>{{vm.tableTools.pagination.start}} - {{vm.tableTools.pagination.end}} {{::vm.tableTools.lang.from}} {{vm.tableTools.filteredCount}}</span></span> <span ng-show="vm.tableTools.filteredCount !== vm.tableTools.dataLength">({{::vm.tableTools.lang.filteredResults}} {{vm.tableTools.dataLength}})</span></div><div class="clearfix"></div>')}]);
//# sourceMappingURL=angularjs-bootstrap4-table-tools.min.js.map
